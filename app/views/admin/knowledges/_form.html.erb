<%= tinymce_assets %>
<div class="container-fluid">
  <ul class="breadcrumb">
    <li><p>YOU ARE HERE</p></li> 
    <li><a href="">Knowledge Management</a></li>
    <li><a href="#" class="active">New</a></li>
  </ul>
</div>
<div class="page-title">
  <i class="fa fa-envelope"></i>
  <h3>Knowledge <span class="semi-bold">Management</span></h3>
</div>
  <div class="grid simple">
    <%= form_for @knowledge, url: knowledges_path, html: { multipart: true } do |f| %>

        <div class="grid-title no-border"></div>
            <div class="grid-body no-border">
                <div class="gen-form" action="">
                 
                  <div class="form-group row">
                        <label class="form-label col-sm-12"><strong>Article Name</strong></label>
                        <div class="controls col-sm-12">             
                            <%= f.text_field :article_name, :class => "full-width", :placeholder => "Article Name" %>
                        </div>
                     </div>
                     
                     <div class="form-group row">
                      <div class="form-label col-sm-12">
                            <label class="form-label"><strong>Categories</strong></label>
                            <span class="help">e.g. "Business", "Technical"</span>
                        </div>
                        <div class="controls col-sm-12">
                            <% if params[:action] == 'edit' %>
                              <%= f.autocomplete_field :category_id, autocomplete_name_knowledges_url, 'data-delimiter' => ',', :multiple => true, class: "autocomplete-field-input", placeholder: "Categories", value: (f.object.knowledge_receivers.present? ? f.object.knowledge_receivers.map{ |receiver| receiver.category.name }.join(', ') : params[:knowledge][:category_id]) %> 
                            <% else %>
                                <%= f.autocomplete_field :category_id, autocomplete_name_knowledges_url, 'data-delimiter' => ',', :multiple => true, class: "autocomplete-field-input", placeholder: "Categories" %> 
                            <% end %>
                                     
                        </div>
                     </div>
                    </div>
<!-- =======
      <%= raw @knowledge.errors.full_messages.join('</br>') if @knowledge.errors.full_messages.present? %>
      <% knowledge_receivers = f.object.knowledge_receivers %>
      <div class="grid-title no-border"></div>
        <div class="grid-body no-border">
          <div class="gen-form" action="">
            <div class="form-group row">
              <label class="form-label col-sm-12"><strong>Article Name</strong></label>
              <div class="controls col-sm-12">
                <%= f.text_field :article_name, :class => "full-width", :placeholder => "Article Name" %>
              </div>
             </div>
             <div class="form-group row">
               <div class="form-label col-sm-12">
                 <label class="form-label"><strong>Categories</strong></label>
                 <span class="help">e.g. "Business", "Technical"</span>
               </div>
                <div class="controls col-sm-12">
                  <%= f.autocomplete_field :category_id, autocomplete_name_knowledges_url, 'data-delimiter' => ',', :multiple => true, class: "autocomplete-field-input",
                    placeholder: "Categories",
                    value: knowledge_receivers.present? ? (knowledge_receivers.map{ |receiver| receiver.category.name }).join(",") : (params[:knowledge][:category_id] rescue '') %>
>>>>>>> 971d3b8cfaab917baa11e6fe7b6dd1f66d1302f6 -->
                </div>
             </div>
      
      <div class="col-sm-12"> 
        <div class="grid simple">
          <%= f.text_area :content,  :id => "text-editor", :placeholder => "Enter text  ...", :class => "form-control tinymce", :rows => "10" %>
                    </div>
                    </div>
                    

                    <!-- <div action="#" class="dropzone no-margin">
                      <div class="fallback">
                        <%= f.file_field :image %><br>                   
                        <%= f.submit "Submit" %>
                      </div>
                    </div> --> 

                      <div class="col-sm-3">
                              <div class="profile-user del-mrg">
                                    <a class="opt-profile change tip btn-upload" data-toggle="tooltip" data-placement="top" data-original-title="Upload"><i class="fa fa-upload" onclick="$('#knowledge_image').click();"></i></a>
                                    <%= f.file_field :image, class: "opt-profile change tip hidden fa fa-upload", :data => {toggle: 'tooltip', placement: 'top', 'original-title' => 'Upload'}, placeholder: "Upload your image", :onchange =>"readURL(this);"%>
                                      
                                  
                                        <img id="img_prev" src="/assets/gallery/Actions-insert-image-icon.png"/>
                                  
                                </div>
                            </div>

      
            <div class="form-actions">  
                <div class="pull-right">
                  <!-- <button type="button" class="btn btn-cons"> Preview </button> -->
                  <%= submit_tag 'Preview', class: "btn btn-success btn-cons", :name => 'preview_button' %>
                  <%= button_tag class: "btn btn-success btn-cons", type: "submit", name: "commit", value: "publish" do %>
                    Save and Publish <i class="fa fa-send"></i>
                  <% end %>
                  <%= button_tag class: "btn btn-success btn-cons", type: "submit", name: "commit", value: "save" do %>
                    Save
                  <% end %>
                </div>
            </div>
    <% end %>

  <script type="text/javascript">
    $('#select_send').change(function(){
      var value = $(this).val();
      if(value == 'emp'){
        $('#emp_text').show('fast');
      }else{
        $('#emp_text').hide('fast')
      }
    });
    </script>

<script type="text/javascript">
  function readURL(input) {
    if (input.files && input.files[0]) {
      var reader = new FileReader();

      reader.onload = function (e) {
        $('#img_prev')
          .attr('src', e.target.result)
          .width(240)
          .height(250);
      };

      reader.readAsDataURL(input.files[0]);
    }
  }
</script>
<%= tinymce %>
